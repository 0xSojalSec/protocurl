version: "3.9"

services:
  client:
    image: protocurl:v1
    container_name: client
    environment:
      # todo. also add documentation on raw text format for request.
      # todo. for json support, we need to extend the base image to use the SDK of any programming language to achieve it.
      # or perhaps use https://github.com/revinate/protobuf2json directly then? No. We don't know, if it works reliably and has little bugs...
      # Let's use protobufjs or the C++ protobuf implementation instead

      URL: "http://localhost:8080/happy-day/verify"
      RESPONSE_TYPE: happyday.HappyDayResponse

      #      URL: "http://localhost:8080/echo"
      #      RESPONSE_TYPE: happyday.HappyDayRequest

      REQUEST_TXT: 'includeReason: true, date: { seconds: 1648044939, nanos: 152000000 }'

      # relevant test cases
      #      REQUEST_TXT: ''
      # REQUEST_TXT: 'includeReason: true, date: { seconds: 1234567890102030405, nanos: 50 }'

      PROTO_FILE_PATH: happyday.proto
      REQUEST_TYPE: happyday.HappyDayRequest

      DISPLAY_BINARY: "true"
      DISPLAY_RESPONSE_HEADERS: "false"

    volumes:
      - ../proto:/proto
    network_mode: host

# TODO. we need to move from compose.env to also support command line args.